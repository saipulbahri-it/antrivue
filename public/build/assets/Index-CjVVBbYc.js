import{_ as P}from"./AuthenticatedLayout-DC2h5dqf.js";import{d as Q,r as p,x as k,w as V,W as $,c as v,o as f,a as o,u as l,g as z,b as r,e as s,s as q,l as g,t as y,j as A,F as C,O as B}from"./app-I_EO46gW.js";import{s as b}from"./index-BeAKCLtd.js";import{a as E,s as d}from"./index-C73n7zrQ.js";import{s as O}from"./index-ekTKN4D7.js";import{s as j}from"./index-Dvo0EJPa.js";import{s as W}from"./index-CV1oTniJ.js";import"./ApplicationLogo-BE2clj38.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C-1LINfG.js";import"./index-C0sk7RJL.js";import"./index-Bxm6Fxdt.js";import"./index-wugWXVqD.js";import"./index-DJBvqMTy.js";const G={class:"flex"},H={class:"ml-auto"},J={class:"py-12"},K={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},M={class:"mb-5 flex gap-2"},R={class:"relative"},X={class:"relative"},Y={class:"relative"},Z={class:"overflow-hidden bg-white text-sm shadow-sm sm:rounded-lg dark:bg-gray-800"},ee={class:"p-6 text-gray-900 dark:text-gray-100"},te={key:0},ae={class:"flex items-center justify-between"},se={class:"text-sm text-gray-500"},le={class:"mb-8 flex flex-col items-center gap-4"},he=Q({__name:"Index",props:{queues:{},services:{},counters:{},queueStatuses:{},selectedDate:{},status:{},service_id:{},counter_id:{}},setup(n){const L=p(n.services.map(a=>({...a,id:String(a.id)}))),N=p(n.counters.map(a=>({...a,id:String(a.id)}))),u=p(typeof n.selectedDate=="string"?new Date(n.selectedDate):null),h=a=>{var _,S,D;const e={year:"numeric",month:"2-digit",day:"2-digit"},t=new Intl.DateTimeFormat("id",e).formatToParts(a),w=(_=t.find(c=>c.type==="year"))==null?void 0:_.value,F=(S=t.find(c=>c.type==="month"))==null?void 0:S.value,U=(D=t.find(c=>c.type==="day"))==null?void 0:D.value;return`${w}-${F}-${U}`},m=p(!1),x=k({service_id:null}),i=k({service_id:n.service_id,counter_id:n.counter_id,status:n.status});V(i,async a=>{const e={service_id:a.service_id,counter_id:a.counter_id,status:a.status};$.reload({only:["queues"],data:{...e,selectedDate:u.value?h(u.value):null}})},{deep:!0}),V(u,async a=>{if(a)try{i.reset(),await $.get("/queue",{selectedDate:h(a)},{preserveState:!0})}catch(e){console.error("Error fetching services:",e)}});const I=a=>{x.service_id=a,x.post("/queue",{onSuccess:e=>{console.log("Queue added successfully",e),m.value=!1},onError:e=>{console.error("Failed to add queue:",e),m.value=!0}})},T=a=>{switch(a){case"waiting":return"warn";case"calling":return"success";case"done":return"info";case"skipped":return"danger";default:return}};return(a,e)=>(f(),v(C,null,[o(l(z),{title:"Queue"}),o(P,null,{header:r(()=>[s("div",G,[e[6]||(e[6]=s("div",{class:"mr-auto"},[s("h2",{class:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200"}," Queue ")],-1)),s("div",H,[o(l(W),{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),"date-format":"yy-mm-dd",size:"small",placeholder:"Select Date",showIcon:!0},null,8,["modelValue"])])])]),default:r(()=>[s("div",J,[s("div",K,[s("div",M,[s("div",R,[o(l(b),{modelValue:l(i).service_id,"onUpdate:modelValue":e[1]||(e[1]=t=>l(i).service_id=t),options:[{name:"Semua",id:""},...L.value],"option-value":"id","option-label":"name",placeholder:"Pilih layanan"},null,8,["modelValue","options"]),e[7]||(e[7]=s("label",{for:"service",class:"absolute left-0 top-0 -translate-y-full transform"},[s("span",{class:"text-sm text-gray-500"}," Layanan ")],-1))]),s("div",X,[o(l(b),{modelValue:l(i).status,"onUpdate:modelValue":e[2]||(e[2]=t=>l(i).status=t),options:[{label:"Semua",value:""},...a.queueStatuses],"option-value":"value","option-label":"label",placeholder:"Pilih Status"},null,8,["modelValue","options"]),e[8]||(e[8]=s("label",{for:"service",class:"absolute left-0 top-0 -translate-y-full transform"},[s("span",{class:"text-sm text-gray-500"}," Status ")],-1))]),s("div",Y,[o(l(b),{modelValue:l(i).counter_id,"onUpdate:modelValue":e[3]||(e[3]=t=>l(i).counter_id=t),options:[{name:"Semua",id:""},...N.value],"option-value":"id","option-label":"name",placeholder:"Pilih Counter",class:"w-full"},null,8,["modelValue","options"]),e[9]||(e[9]=s("label",{for:"service",class:"absolute left-0 top-0 -translate-y-full transform"},[s("span",{class:"text-sm text-gray-500"}," Counter ")],-1))]),o(l(q),{class:"ml-auto",onClick:e[4]||(e[4]=t=>m.value=!0)},{default:r(()=>e[10]||(e[10]=[g(" Ambil Nomor ")])),_:1})]),s("div",Z,[s("div",ee,[o(l(E),{value:a.queues,size:"small",responsiveLayout:"scroll",class:"w-full",paginator:!0,rows:10,"rows-per-page-options":[10,20,50],"empty-message":a.queues.length===0,"show-current-page-report":!0},{footer:r(()=>[s("div",ae,[s("span",se," Total "+y(a.queues?a.queues.length:0)+" antrian. ",1)])]),empty:r(()=>e[11]||(e[11]=[s("div",{class:"text-center"},[s("p",{class:"text-sm text-gray-500"}," Tidak ada antrian. ")],-1)])),default:r(()=>[o(l(d),{field:"id",header:"ID"}),o(l(d),{field:"service.name",header:"Layanan"}),o(l(d),{field:"counter.name",header:"Counter"}),o(l(d),{field:"number",header:"Nomor"}),o(l(d),{field:"status",header:"Status"},{body:r(t=>[o(l(O),{value:t.data.status,severity:T(t.data.status)},null,8,["value","severity"])]),_:1}),o(l(d),{field:"created_at",header:"Tanggal"},{body:r(t=>[g(y(new Date(t.data.created_at).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})),1)]),_:1}),o(l(d),{field:"called_at",header:"Dipanggil"},{body:r(t=>[t.data.called_at?(f(),v("div",te,y(new Date(t.data.called_at).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})),1)):A("",!0)]),_:1})]),_:1},8,["value","empty-message"])])])])]),o(l(j),{visible:m.value,"onUpdate:visible":e[5]||(e[5]=t=>m.value=t),modal:"",header:"Ambil Nomor Antrian",style:{width:"25rem"}},{default:r(()=>[e[12]||(e[12]=s("span",{class:"text-surface-500 dark:text-surface-400 mb-8 block"}," Pilih Layanan. ",-1)),s("div",le,[(f(!0),v(C,null,B(a.services,t=>(f(),v("div",{key:t.id,class:"w-full"},[o(l(q),{size:"large",severity:"secondary",variant:"outlined",class:"w-full p-4",onClick:w=>I(t.id),label:t.name,iconPos:"left"},{default:r(()=>[g(y(t.name),1)]),_:2},1032,["onClick","label"])]))),128))])]),_:1},8,["visible"])]),_:1})],64))}});export{he as default};
