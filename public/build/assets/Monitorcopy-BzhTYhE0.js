import{A as k}from"./ApplicationLogo-BY06AJv4.js";import{s as y}from"./index-wXlZKAty.js";import{d as C,r as u,V as h,w as F,c as _,o as p,e,a as N,n as V,t as l,F as S,O as q,k as z,b as f,u as B}from"./app-BWNrNjCQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"m-5 h-full"},j={class:"relative grid gap-6 lg:grid-cols-3 lg:gap-8"},E={class:"flex flex-col items-start gap-6 overflow-hidden rounded-lg bg-white p-6 shadow-[0px_14px_34px_0px_rgba(0,0,0,0.08)] ring-1 ring-white/[0.05] transition duration-300 hover:text-black/70 hover:ring-black/20 focus:outline-none focus-visible:ring-[#FF2D20] md:row-span-3 lg:p-10 lg:pb-10 dark:bg-zinc-900 dark:ring-zinc-800 dark:hover:text-white/70 dark:hover:ring-zinc-700 dark:focus-visible:ring-[#FF2D20]"},A={class:"flex pb-5"},I={class:"flex items-center gap-2"},L={class:"text-5xl font-bold text-yellow-500"},M={class:"font-mono text-9xl font-bold text-green-800 transition"},$={class:"flex items-center gap-2"},O={class:"text-2xl font-bold"},P={class:"relative flex flex-col items-center gap-6 lg:items-end"},R={class:"m-5 flex items-center gap-2"},U={class:"text-4xl font-bold"},G={class:"font-mono text-8xl font-bold text-gray-800 transition"},T=C({__name:"Monitorcopy",props:{services:{},counters:{}},setup(v){const c=u(null),m=u([]),d=u(!1);h(()=>{g(),setInterval(g,1e4)});const g=async()=>{await x(),await b()},x=async()=>{console.log("start:checkForNewCall");const t=await(await fetch("/api/queue/next-call")).json();t&&t.id&&(c.value=t,d.value=!0,console.log("start:playVoice"),await w(t.number,t.counter.name),console.log("end:playVoice"),d.value=!1),console.log("end:checkForNewCall")},b=async()=>{const t=await(await fetch("/api/queue/recent-call")).json();m.value=t};F(m,a=>{v.counters.forEach(t=>{const s=a.find(n=>n.counter.id===t.id);s&&(t.last_queue_called={...s,status:s.status||"",counter_id:s.counter.id,service_id:s.service.id})})});const w=async(a,t)=>new Promise((s,n)=>{try{const r=`Nomor antrean ${a}, silakan menuju loket ${t}`,o=new SpeechSynthesisUtterance(r);o.lang="id-ID",o.rate=.95,o.onend=()=>{console.log("Voice selesai diputar"),s(void 0)},o.onerror=i=>{console.error("Error saat memutar suara:",i.error),n(i.error)},speechSynthesis.cancel(),speechSynthesis.speak(o)}catch(r){n(r)}});return h(()=>{}),(a,t)=>{var s,n,r;return p(),_("div",D,[t[0]||(t[0]=e("img",{id:"background",class:"absolute -left-20 top-0 max-w-[877px]",src:"https://aibvalue.com/images/background.svg"},null,-1)),e("div",j,[e("div",E,[e("div",A,[e("div",null,[N(k)])]),e("div",{class:V(["border-primary-500 relative flex w-full flex-1 flex-col justify-between rounded-3xl border border-2 p-5",[{"animate-pulse":d.value}]])},[e("div",I,[e("h2",L,l((s=c.value)==null?void 0:s.counter.name),1)]),e("p",M,l((n=c.value)==null?void 0:n.number),1),e("div",$,[e("h2",O,l((r=c.value)==null?void 0:r.service.name),1)])],2),e("div",P,[e("div",null,l(c.value),1)])]),(p(!0),_(S,null,q(a.counters,o=>(p(),z(B(y),{key:o.id,class:"rounded-3xl border"},{header:f(()=>[e("div",R,[e("h2",U,l(o.name),1)])]),content:f(()=>{var i;return[e("p",G,l(((i=o.last_queue_called)==null?void 0:i.number)||"-"),1)]}),footer:f(()=>[e("div",null,l(o.service.name),1)]),_:2},1024))),128))])])}}});export{T as default};
