import{d as q,r as _,f as A,x as V,h as F,c as d,o as u,a,b as n,u as e,e as o,s as m,i as S,j as c,t as v,F as L,W}from"./app-BWNrNjCQ.js";import{s as b,a as z}from"./index-DQDpI-0R.js";import{s as y}from"./index-Ckg0UnaT.js";import{s as x}from"./index-C-9JGpXp.js";import{s as k}from"./index-BJLWZoJf.js";import{s as U}from"./index-C45ElIFY.js";import{s as h}from"./index-C89LGhrP.js";import{s as T}from"./index-Dk6ixdfn.js";const Y={class:"flex justify-end gap-2 text-end"},G={class:"flex items-center justify-between"},H={class:"inline-flex flex-col gap-2"},I={key:0,class:"text-sm text-red-500"},J={class:"inline-flex flex-col gap-2"},K={key:0,class:"text-sm text-red-500"},O={key:0,class:"inline-flex flex-col gap-2"},Q={key:0,class:"text-sm text-red-500"},X={class:"flex justify-between gap-2"},Z={class:"inline-flex flex-col gap-2"},ee={key:0,class:"text-sm text-red-500"},se={class:"inline-flex flex-col gap-2"},le={key:0,class:"text-sm text-red-500"},ae={class:"flex justify-between gap-2"},re={class:"inline-flex flex-col gap-2"},oe={class:"inline-flex flex-col gap-2"},te={key:0,class:"text-sm text-red-500"},ie={class:"flex justify-between gap-2"},be=q({__name:"UserCrud",props:{users:{},counters:{}},setup(ne){const $=_([{label:"Admin",value:"admin"},{label:"Counter",value:"counter"}]),f=A(),p=_(!1),E=_(null),s=V({id:null,name:"",email:"",role:"",counter_id:null,password:""}),N=()=>{s.reset(),p.value=!0},P=i=>{s.id=i.id,s.name=i.name,s.email=i.email,s.role=i.role,s.counter_id=i.counter_id,p.value=!0},g=()=>{s.id&&(s.reset(),p.value=!1),t.id&&(t.reset(),w.value=!1)},j=()=>{s.id?s.put(`/users/${s.id}`,{preserveScroll:!0,onSuccess:()=>{f.add({severity:"success",summary:"Success",detail:"User updated successfully",life:3e3}),s.reset(),p.value=!1},onError:i=>{console.error("Error updating user:",i)}}):s.post("/users",{preserveScroll:!0,onSuccess:()=>{f.add({severity:"success",summary:"Success",detail:"User saved successfully",life:3e3}),s.reset(),p.value=!1},onError:i=>{console.error("Error saving user:",i)}})},t=V({id:null,name:"",new_password:""}),w=_(!1),M=i=>{t.reset(),t.id=i.id,t.name=i.name,t.new_password="",w.value=!0},R=()=>{t.put(`/users/${t.id}/change-password`,{preserveScroll:!0,onSuccess:()=>{f.add({severity:"success",summary:"Success",detail:"Password changed successfully",life:3e3}),t.reset(),w.value=!1},onError:i=>{console.error("Error changing password:",i)}})},B=F(),D=i=>{B.require({message:`Are you sure you want to delete this user ${i.name} ?`,header:"Delete Confirmation",icon:"pi pi-exclamation-triangle",acceptLabel:"Yes",rejectLabel:"No",acceptClass:"p-button-danger",accept:()=>{W.delete(`/users/${i.id}`,{preserveScroll:!0,onSuccess:()=>{f.add({severity:"info",summary:"Success",detail:"User deleted successfully",life:3e3})},onError:l=>{f.add({severity:"error",summary:"Error",detail:l[0],life:3e3})}})},reject:()=>{E.value=null,f.add({severity:"warn",summary:"Cancelled",detail:"User deletion cancelled",life:3e3})}})};return(i,l)=>(u(),d(L,null,[a(e(z),{class:"w-full text-sm",value:i.users,size:"small",onRowSelect:l[0]||(l[0]=r=>e(s).name=r.data.name)},{header:n(()=>[o("div",G,[l[10]||(l[10]=o("div",{class:"flex items-center gap-2"},[o("h3",{class:"text-lg font-semibold"},"Users")],-1)),a(e(m),{rounded:"",outlined:"",class:"p-button-sm p-button-success",icon:"pi pi-plus",onClick:N})])]),default:n(()=>[a(e(b),{field:"name",header:"Name"}),a(e(b),{field:"email",header:"Email"}),a(e(b),{field:"role",header:"Role"}),a(e(b),{field:"counter.name",header:"Counter"}),a(e(b),{"header-class":"text-center",sortable:!1},{body:n(({data:r})=>[o("div",Y,[a(e(m),{rounded:"",icon:"pi pi-key",class:"p-button-sm",outlined:"",severity:"primary",onClick:C=>M(r)},null,8,["onClick"]),a(e(m),{rounded:"",icon:"pi pi-pencil",class:"p-button-sm",outlined:"",severity:"info",onClick:C=>P(r)},null,8,["onClick"]),a(e(m),{rounded:"",icon:"pi pi-trash",class:"p-button-sm",outlined:"",severity:"warn",onClick:C=>D(r)},null,8,["onClick"])])]),_:1})]),_:1},8,["value"]),a(e(h),{visible:p.value,"onUpdate:visible":l[6]||(l[6]=r=>p.value=r),modal:"",header:e(s).id?"Edit User":"New User",style:{width:"35rem"}},{default:n(()=>[o("form",{class:"flex w-full flex-col gap-4",onSubmit:S(j,["prevent"])},[o("div",H,[a(e(y),{variant:"in"},{default:n(()=>[a(e(x),{id:"name",modelValue:e(s).name,"onUpdate:modelValue":l[1]||(l[1]=r=>e(s).name=r),invalid:!!e(s).errors.name,variant:e(s).name?"filled":"outlined",fluid:""},null,8,["modelValue","invalid","variant"]),l[11]||(l[11]=o("label",{for:"name"},"Name",-1))]),_:1}),e(s).errors.name?(u(),d("span",I,v(e(s).errors.name),1)):c("",!0)]),o("div",J,[a(e(y),{variant:"in"},{default:n(()=>[a(e(x),{id:"email",modelValue:e(s).email,"onUpdate:modelValue":l[2]||(l[2]=r=>e(s).email=r),invalid:!!e(s).errors.email,variant:e(s).email?"filled":"outlined",fluid:""},null,8,["modelValue","invalid","variant"]),l[12]||(l[12]=o("label",{for:"email"},"Email",-1))]),_:1}),e(s).errors.email?(u(),d("span",K,v(e(s).errors.email),1)):c("",!0)]),e(s).id?c("",!0):(u(),d("div",O,[a(e(y),{variant:"in"},{default:n(()=>[a(e(x),{id:"password",modelValue:e(s).password,"onUpdate:modelValue":l[3]||(l[3]=r=>e(s).password=r),invalid:!!e(s).errors.password,variant:e(s).password?"filled":"outlined",type:"password",fluid:""},null,8,["modelValue","invalid","variant"]),l[13]||(l[13]=o("label",{for:"password"},"Password",-1))]),_:1}),e(s).errors.password?(u(),d("span",Q,v(e(s).errors.password),1)):c("",!0)])),o("div",X,[o("div",Z,[a(e(k),{class:"w-full md:w-56"},{default:n(()=>[a(e(U),{id:"role",modelValue:e(s).role,"onUpdate:modelValue":l[4]||(l[4]=r=>e(s).role=r),options:$.value,"option-value":"value","option-label":"label",placeholder:"Select Role",invalid:!!e(s).errors.role,class:"w-full",variant:e(s).role?"filled":"outlined"},null,8,["modelValue","options","invalid","variant"]),l[14]||(l[14]=o("label",{for:"role"}," Role ",-1))]),_:1}),e(s).errors.role?(u(),d("span",ee,v(e(s).errors.role),1)):c("",!0)]),o("div",se,[a(e(k),{class:"w-full md:w-56"},{default:n(()=>[a(e(U),{id:"counter",modelValue:e(s).counter_id,"onUpdate:modelValue":l[5]||(l[5]=r=>e(s).counter_id=r),options:[{name:"Select Counter",id:null},...i.counters],"option-value":"id","option-label":"name",placeholder:"Select Counter",invalid:!!e(s).errors.counter_id,class:"w-full",variant:e(s).counter_id?"filled":"outlined"},null,8,["modelValue","options","invalid","variant"]),l[15]||(l[15]=o("label",{for:"counter"}," Counter ",-1))]),_:1}),e(s).errors.counter_id?(u(),d("span",le,v(e(s).errors.counter_id),1)):c("",!0)])]),o("div",ae,[a(e(m),{type:"button",severity:"secondary",label:"Cancel",onClick:g}),a(e(m),{type:"submit",label:"Simpan",disabled:e(s).processing},null,8,["disabled"])])],32)]),_:1},8,["visible","header"]),a(e(h),{visible:w.value,"onUpdate:visible":l[9]||(l[9]=r=>w.value=r),modal:"",header:`Change Password for ${e(t).name}`,style:{width:"35rem"}},{default:n(()=>[o("form",{class:"flex w-full flex-col gap-4",onSubmit:S(R,["prevent"])},[o("div",re,[a(e(y),{variant:"in"},{default:n(()=>[a(e(x),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":l[7]||(l[7]=r=>e(t).name=r),invalid:!!e(t).errors.name,variant:e(t).name?"filled":"outlined",fluid:"",disabled:""},null,8,["modelValue","invalid","variant"]),l[16]||(l[16]=o("label",{for:"name"},"Name",-1))]),_:1})]),o("div",oe,[a(e(y),{variant:"in"},{default:n(()=>[a(e(x),{id:"new_password",modelValue:e(t).new_password,"onUpdate:modelValue":l[8]||(l[8]=r=>e(t).new_password=r),invalid:!!e(t).errors.new_password,variant:e(t).new_password?"filled":"outlined",type:"password",fluid:""},null,8,["modelValue","invalid","variant"]),l[17]||(l[17]=o("label",{for:"new_password"},"New Password",-1))]),_:1}),e(t).errors.new_password?(u(),d("span",te,v(e(t).errors.new_password),1)):c("",!0)]),o("div",ie,[a(e(m),{type:"button",severity:"secondary",label:"Cancel",onClick:g}),a(e(m),{type:"submit",label:"Change Password",disabled:e(t).processing},null,8,["disabled"])])],32)]),_:1},8,["visible","header"]),a(e(T))],64))}});export{be as _};
